# Output Documentation

This document summarizes the outputs generated by the QTLight pipeline, which supports eQTL mapping using LIMIX, TensorQTL, JAXQTL, and SAIGE-QTL. Outputs are organized by method.

---

## TensorQTL Outputs

**Output directory**: `TensorQTL_eQTLS/<condition>/`


### Core Results

In each `proc_4pcs/base_output/base/` directory:

- `Cis_eqtls_qval.tsv`  
  Final FDR-corrected cis-eQTLs (q-values).
- `Cis_eqtls.tsv`  
  All tested cis-eQTLs with nominal p-values.
- `Covariates.tsv`  
  Matrix of covariates used in the association testing.
- `Expression_Data.sorted.bed`  
  BED-format gene expression data used for TensorQTL input.

---

### Nominal Association Results

In each `OPTIM_pcs/base_output/base/` directory:

- `cis_nominal1.cis_qtl_pairs.<CHR>.tsv.gz`  
  Per-chromosome nominal cis-eQTL results (only if nominal pass was run).
- `Cis_eqtls.tsv`, `Cis_eqtls_qval.tsv`, `Covariates.tsv`, `Expression_Data.sorted.bed`  
  Same as above, replicated under optimization output for reference.

---

### PC Optimization Outputs

In each `OPTIM_pcs/base_output__base/` directory:

- `optimise_nPCs-FDR1.txt`  
  Optimal number of phenotype PCs per condition (based on eGene yield).
- `optimise_nPCs-FDR1.pdf`  
  Plot of FDR q-value vs. number of PCs.
- `optim_pcs.txt`  
  Summary of the optimization process and selected PCs.

---

### Input Snapshot

In each `OPTIM_input/base_output__base/` directory:

- `Cis_eqtls_qval.tsv`, `Covariates.tsv`, `Expression_Data.sorted.bed`, `fake_file.fq`  
  These reflect the exact inputs used during the optimized TensorQTL run.

---

### Structure Summary

Each condition or phenotype-level directory may include:

- `OPTIM_input/` → raw input files used for QTL mapping  
- `OPTIM_pcs/` → results from PC optimization, including:
  - `optimise_nPCs-FDR*.pdf` / `.txt` → plots and tables of eGene discovery vs. PC count  
  - `base_output/base/` → full nominal cis-QTL results per tested PC count (e.g., `cis_qtl_pairs.*.tsv.gz`, `Cis_eqtls.tsv`, `Cis_eqtls_qval.tsv`)  
- `<n>pcs/` → final output using the selected number of phenotype PCs (e.g., `4pcs/`, `6pcs/`, etc.), containing only filtered results like `Cis_eqtls.tsv`, `Cis_eqtls_qval.tsv`, `Covariates.tsv`, and `Expression_Data.sorted.bed`  


---

## LIMIX Outputs

**Output directory**: `Limix_eQTLS/<group1>__<group0>/<group2>/results_<group1>/`

### Primary Outputs

- `qtl_results_all.h5`: All QTL statistics in HDF5 format.
- `snp_metadata_all.txt`: Per-variant metadata (e.g. position, MAF, filtering).
- `feature_metadata_all.txt`: Per-gene metadata used in QTL mapping.

### FDR-Filtered Results

- `qtl_results_all_FDR_*.tsv`: QTL results filtered at different FDR thresholds (e.g. 0.05, 0.01).

---

## JAXQTL Outputs

**Output directory**: `JAX_eQTLS/<group0>__<group1>__<group2>/`

### cis-QTL Results

- `OPTIM_PCs/<mode>/*cis_score.tsv.gz`: Per-gene cis-QTL scores using a negative binomial model.
- `OPTIM_PCs/<mode>/*cis_qtl_pairs.*.parquet`: Nominal QTL results in Parquet format.

### Aggregated and Optimized Outputs

- `<group0>__<group1>__<group2>__<mode>__merged_cis_scores.tsv.gz`: Combined cis-QTL results across all chunks.
- `results/optimise_nPCs-FDR<alpha>.txt`: Optimal PC counts for each condition at the specified FDR.
- `results/optimise_nPCs-FDR<alpha>.pdf`: PC vs eGene plots.

---

## SAIGE-QTL Outputs

**Output directory**: `Saige_eQTLS/<condition>/`

### Core cis-QTL Results

- `minimum_q_all_genes.tsv`: Minimum q-value per gene after multiple testing.
- `ACAT_all.tsv`: ACAT-combined p-values across all cis-variants per gene.
- `<chr>__<condition>__all_vars_genes.tsv.gz`: Complete cis gene-variant association matrix.
- `<chr>__<condition>__gene_lambdas.tsv`: Lambda inflation factors per gene.

---
